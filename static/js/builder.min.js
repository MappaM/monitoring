(function(){function e(e,t){for(var n=0;n<floors.length;n++)if(floors[n].floor.contains(t))return!0;return!1}function t(e,t){floors.push(new Floor);for(var n=floors.length-1;n>=e;n--)n==e?floors[n]=t:floors[n]=floors[n-1]}function n(e,t){t.displayMessage("Saving...");var n=$(e.target).data("floor");labels=undefined,save(function(){selectedFloor=n,selectedFloor<floors.length-1&&!floors[selectedFloor+1].floor.contains("CELLAR")?t.getFloorContent(floors[selectedFloor].pk,floors[selectedFloor+1].pk):floors[selectedFloor].floor.contains("CELLAR")?t.getFloorContent(floors[selectedFloor].pk,floors[selectedFloor-1].pk):t.getFloorContent(floors[selectedFloor].pk),i(t)})}function r(){return tool=$("#tool:checked").val(),tool!=undefined?tool:$("#tool").val()}function i(e){var t=100,r=100/floors.length;$("#floor_show").html("");var i="#de77aa",o="#44339e",u="#AA77De";for(var a=0;a<floors.length;a++){var f="float:none;width:"+t+"px;height:"+r+"px;margin:auto;padding:0;border-radius:0;",l=!0;floors[a].floor=="ROOF_ATTIC"&&(l=!1);var c=undefined;floors[a].floor.contains("ROOF")?(floors[a].floor=="ROOF_ATTIC"?s=0:s=r/3,c=$('<canvas  width="'+(t+2)+'" height="'+(r+2)+'" style="'+f+'" class="floor_draw floor_'+floors[a].floor.toLowerCase()+'" id="floor_roof"></canvas>'),$("#floor_show").append(c),c.ready(function(){var e=document.getElementById("floor_roof"),n=e.getContext("2d"),f=r-s;n.moveTo(1,f+2),n.lineTo(t/2+1,1),n.lineTo(t+1,f+2),n.lineTo(t+1,f+s+1),n.lineTo(1,f+s+1),n.lineTo(1,f+2),n.lineWidth=1,n.stroke(),l?($(e).css("cursor","pointer"),selectedFloor==a?n.fillStyle=o:n.fillStyle=u):n.fillStyle=i,n.fill()})):!floors[a].floor.contains("SLAB")&&floors[a].floor!="CRAWL_SPACE"&&(selectedFloor==a?f+="background-color:"+o+";":f+="background-color:"+u+";",c=$('<div class="floor_draw floor_'+floors[a].floor.toLowerCase()+'" style="'+f+'cursor:pointer;">&nbsp;</div>'),$("#floor_show").append(c)),c!=undefined&&(c.data("floor",a),l&&c.click(function(t){n(t,e)}))}}String.prototype.contains=function(e){return this.indexOf(e)!=-1}}).call(this);
